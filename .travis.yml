language: c

os:
  - osx

env:
  global:
  - NODE_PRE_GYP_GITHUB_TOKEN=6a7df9a737a10f5ebab55bc0eb39419a5ee70e66
  matrix:
  - NODE_VERSION="4.2.4"

install:
- export PATH=./node_modules/.bin/:$PATH

script:
- npm install --build-from-source --node-gyp=$(which pangyp)
- "./node_modules/.bin/node-pre-gyp package"
- echo $TRAVIS_TAG
- echo $TRAVIS_PULL_REQUEST
- >
    ([[ "$TRAVIS_TAG" =~ ^v[0-9] ]] &&
    test "$TRAVIS_PULL_REQUEST" = false &&
    ./node_modules/.bin/node-pre-gyp publish) || true
- node-pre-gyp-github publish --release
